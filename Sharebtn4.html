<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Firebase Share Counter</title>
</head>
<body>

<h2>My Article</h2>
<button id="shareBtn">Share Article</button>
<p>Total Shares: <span id="shareCount">0</span></p>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
  // Firebase config - apna correct config dalna
  const firebaseConfig = {
    apiKey: "AIzaSyCvS35O-TEWh7YBA28sXa1VEzozwOYR6Y4",
    authDomain: "todaylite-github-share.firebaseapp.com",
    databaseURL: "https://todaylite-github-share-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "todaylite-github-share",
    storageBucket: "todaylite-github-share.firebasestorage.app",
    messagingSenderId: "149613187050",
    appId: "1:149613187050:web:87e2e35d4e76924ceaac93",
    measurementId: "G-KD18PK3VBZ"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // For testing, manually set articleId. Aage URL se le sakte ho
  const articleId = "article-1";
  console.log("Article ID:", articleId);

  const shareCountRef = db.ref("shares/" + articleId);

  shareCountRef.on("value", snapshot => {
    const count = snapshot.val() || 0;
    document.getElementById("shareCount").textContent = count;
    console.log("Current count:", count);
  });

  document.getElementById("shareBtn").addEventListener("click", () => {
    shareCountRef.transaction(current => {
      console.log("Current count in DB before increment:", current);
      return (current || 0) + 1;
    }, (error, committed, snapshot) => {
      if (error) {
        console.error("Transaction failed:", error);
      } else if (!committed) {
        console.log("Transaction not committed");
      } else {
        console.log("Transaction committed. New count:", snapshot.val());
      }
    });
  });
</script>

</body>
</html>
